(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{2110:function(e,t,s){Promise.resolve().then(s.bind(s,68))},68:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return F}});var i=s(7437),l=s(2265);let a=(0,s(4593).eI)("https://hnmpwugorejesiaicdyj.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImhubXB3dWdvcmVqZXNpYWljZHlqIiwicm9sZSI6ImFub24iLCJpYXQiOjE3Mzk2ODg1OTIsImV4cCI6MjA1NTI2NDU5Mn0._fE06AsE_q-3sZSOcxhwlI6C_fTIVzb9hgUWa3FYAS0");var n=s(7719),r=s.n(n);s(9360);var o=s(4839),c=s(6164);function d(e){if(!e)return"";let[t,s]=e.split(":"),i=parseInt(t,10);return"".concat(i%12||12,":").concat(s).concat(i>=12?"pm":"am")}let m=e=>new Promise(t=>{let s=new FileReader;s.readAsDataURL(e),s.onload=s=>{var i;let l=new Image;l.src=null===(i=s.target)||void 0===i?void 0:i.result,l.onload=()=>{let s=document.createElement("canvas"),i=l.width,a=l.height;i>a?i>1200&&(a*=1200/i,i=1200):a>900&&(i*=900/a,a=900),s.width=i,s.height=a;let n=s.getContext("2d");null==n||n.drawImage(l,0,0,i,a),s.toBlob(s=>{s&&t(new File([s],e.name,{type:"image/jpeg",lastModified:Date.now()}))},"image/jpeg",.7)}}});function x(e){let{events:t,userPos:s,selectedEvent:a,onEventSelect:n}=e,o=(0,l.useRef)(null),c=(0,l.useRef)(null),m=(0,l.useRef)([]),x=(0,l.useRef)([]),[u,p]=(0,l.useState)([-76.9426,38.9869]);(0,l.useEffect)(()=>{s&&p([s[1],s[0]])},[s]);let[h]=(0,l.useState)(16.25),[g]=(0,l.useState)(65),f="pk.eyJ1IjoibHM2MTEwIiwiYSI6ImNtNzZ6Z2x0ODBjaHgyanB5NmlnYTVsMGcifQ.H_LX7IeqmERoNb9Q_t751A";return(0,l.useEffect)(()=>{if(!f||!c.current){console.error("Missing required props");return}r().accessToken=f;let e=new(r()).Map({container:c.current,style:"mapbox://styles/sanjay07/cm7apwi2u005d01p7efst9xll",center:s?[s[1],s[0]]:u,zoom:h,pitch:g,bearing:45,antialias:!0,maxBounds:[[-180,-90],[180,90]]});if(e.addControl(new(r()).NavigationControl({visualizePitch:!0})),e.on("style.load",()=>{e.addSource("mapbox-dem",{type:"raster-dem",url:"mapbox://mapbox.mapbox-terrain-dem-v1",tileSize:512,maxzoom:14}),e.setTerrain({source:"mapbox-dem",exaggeration:1.5}),e.addLayer({id:"3d-buildings",source:"composite","source-layer":"building",filter:["==","extrude","true"],type:"fill-extrusion",minzoom:15,paint:{"fill-extrusion-color":["interpolate",["linear"],["get","height"],0,"#2D3748",50,"#4A5568",100,"#718096",200,"#A0AEC0"],"fill-extrusion-height":["get","height"],"fill-extrusion-base":0,"fill-extrusion-opacity":.8,"fill-extrusion-ambient-occlusion-intensity":1,"fill-extrusion-ambient-occlusion-radius":2,"fill-extrusion-vertical-gradient":!0}})}),m.current.forEach(e=>e.remove()),x.current.forEach(e=>e.remove()),m.current=[],x.current=[],t.forEach(t=>{if(t.latitude&&t.longitude){let s=document.createElement("div"),i=new Date,[l,o,c]=t.date.split("-").map(Number),u=new Date(l,o-1,c),[p,h]=(t.startTime||"").split(":").map(Number),[g,f]=(t.endTime||"").split(":").map(Number),v=new Date(l,o-1,c,p||0,h||0),w=new Date(l,o-1,c,g||23,f||59),b=u>new Date(i.getTime()+864e5),j=(u.toDateString(),i.toDateString(),a===t.id),N=j?"h-1 w-1 sm:h-5 sm:w-5":"h-0.5 w-0.5 sm:h-4 sm:w-4",y=j?"ring-1 sm:ring-[3px]":"ring-1 sm:ring-2";v<=i&&w>=i?s.className="".concat(N," rounded-full bg-red-500 ").concat(y," ring-red-200 shadow-[0px_0px_2px_1px_rgba(239,68,68,0.5)] sm:shadow-[0px_0px_8px_4px_rgba(239,68,68,0.5)] transition-all"):w<i?s.className="".concat(N," rounded-full bg-zinc-500 ").concat(y," ring-zinc-200 shadow-[0px_0px_2px_1px_rgba(161,161,170,0.5)] sm:shadow-[0px_0px_8px_4px_rgba(161,161,170,0.5)] transition-all"):b?s.className="".concat(N," rounded-full bg-purple-500 ").concat(y," ring-purple-200 shadow-[0px_0px_2px_1px_rgba(168,85,247,0.5)] sm:shadow-[0px_0px_8px_4px_rgba(168,85,247,0.5)] transition-all"):s.className="".concat(N," rounded-full bg-green-500 ").concat(y," ring-green-200 shadow-[0px_0px_2px_1px_rgba(34,197,94,0.5)] sm:shadow-[0px_0px_8px_4px_rgba(34,197,94,0.5)] transition-all");let z=new(r()).Popup({closeButton:!1,closeOnClick:!1,className:"shadow-lg",offset:[0,-5]}).setHTML('\n            <div class="p-2 bg-white hover:bg-gray-50 transition-colors rounded-lg">\n                <h3 class="font-medium text-sm text-gray-900">'.concat(t.title,'</h3>\n                <p class="text-xs text-gray-600 mt-0.5">').concat(d(t.startTime)," - ").concat(d(t.endTime),'</p>\n                <p class="text-xs text-gray-500 mt-1">Click to view details</p>\n            </div>\n        ')),k=new(r()).Marker(s).setLngLat([t.longitude,t.latitude]).setPopup(z).addTo(e);s.addEventListener("mouseenter",()=>z.addTo(e)),s.addEventListener("mouseleave",()=>z.remove()),s.addEventListener("click",()=>n(t.id||"")),m.current.push(k),x.current.push(z)}}),s){let t=document.createElement("div");t.className="h-2 w-2 sm:h-6 sm:w-6 text-blue-500 transition-all animate-pulse",t.innerHTML='\n                <svg viewBox="0 0 24 24" fill="currentColor" class="w-full h-full drop-shadow-[0px_0px_8px_rgba(14,165,233,0.8)]">\n                    <path fill-rule="evenodd" d="M11.54 22.351l.07.04.028.016a.76.76 0 00.723 0l.028-.015.071-.041a16.975 16.975 0 001.144-.742 19.58 19.58 0 002.683-2.282c1.944-1.99 3.963-4.98 3.963-8.827a8.25 8.25 0 00-16.5 0c0 3.846 2.02 6.837 3.963 8.827a19.58 19.58 0 002.682 2.282 16.975 16.975 0 001.145.742zM12 13.5a3 3 0 100-6 3 3 0 000 6z" clip-rule="evenodd" />\n                </svg>\n            ';let i=new(r()).Marker(t).setLngLat([s[1],s[0]]).addTo(e);m.current.push(i)}if(a){let s=t.find(e=>e.id===a);(null==s?void 0:s.latitude)&&(null==s?void 0:s.longitude)&&e.flyTo({center:[s.longitude,s.latitude],zoom:a?17:16.25,duration:1e3})}else s&&e.flyTo({center:[s[1],s[0]],zoom:16.25,duration:1e3});return o.current=e,()=>{m.current.forEach(e=>e.remove()),x.current.forEach(e=>e.remove()),e.remove()}},[t,f,u,h,g,s,a,n]),(0,i.jsxs)("div",{className:"h-full w-full relative",children:[(0,i.jsx)("div",{id:"map-container",ref:c,className:"rounded-3xl overflow-hidden shadow-lg h-full w-full"}),(0,i.jsxs)("div",{className:"absolute left-4 bottom-4 bg-black rounded-lg px-3 py-2 space-y-2 w-48 hidden md:block",children:[(0,i.jsxs)("div",{className:"flex items-center",children:[(0,i.jsx)("div",{className:"w-5 h-5 mr-2 flex-shrink-0",children:(0,i.jsx)("svg",{viewBox:"0 0 24 24",fill:"#3b82f6",className:"w-full h-full",children:(0,i.jsx)("path",{d:"M11.54 22.351l.07.04.028.016a.76.76 0 00.723 0l.028-.015.071-.041a16.975 16.975 0 001.144-.742 19.58 19.58 0 002.683-2.282c1.944-1.99 3.963-4.98 3.963-8.827a8.25 8.25 0 00-16.5 0c0 3.846 2.02 6.837 3.963 8.827a19.58 19.58 0 002.682 2.282 16.975 16.975 0 001.145.742zM12 13.5a3 3 0 100-6 3 3 0 000 6z"})})}),(0,i.jsx)("span",{className:"text-blue-300 text-xs",children:"Your Location"})]}),(0,i.jsxs)("div",{className:"flex items-center",children:[(0,i.jsx)("div",{className:"w-5 h-5 mr-2 flex-shrink-0 flex items-center justify-center",children:(0,i.jsx)("div",{className:"w-4 h-4 rounded-full bg-red-500"})}),(0,i.jsx)("span",{className:"text-red-300 text-xs",children:"Ongoing Events"})]}),(0,i.jsxs)("div",{className:"flex items-center",children:[(0,i.jsx)("div",{className:"w-5 h-5 mr-2 flex-shrink-0 flex items-center justify-center",children:(0,i.jsx)("div",{className:"w-4 h-4 rounded-full border-[2px] border-gray-300 bg-transparent"})}),(0,i.jsx)("span",{className:"text-gray-300 text-xs",children:"Past Events"})]}),(0,i.jsxs)("div",{className:"flex items-center",children:[(0,i.jsx)("div",{className:"w-5 h-5 mr-2 flex-shrink-0 flex items-center justify-center",children:(0,i.jsx)("div",{className:"w-4 h-4 rounded-full bg-green-500"})}),(0,i.jsx)("span",{className:"text-green-300 text-xs",children:"Today's Upcoming"})]}),(0,i.jsxs)("div",{className:"flex items-center",children:[(0,i.jsx)("div",{className:"w-5 h-5 mr-2 flex-shrink-0 flex items-center justify-center",children:(0,i.jsx)("div",{className:"w-4 h-4 rounded-full bg-purple-500"})}),(0,i.jsx)("span",{className:"text-purple-300 text-xs",children:"Future Events"})]})]}),(0,i.jsx)("div",{className:"absolute left-2 bottom-2 bg-black bg-opacity-70 rounded-lg p-1.5 md:hidden",children:(0,i.jsx)("button",{className:"flex items-center justify-center","aria-label":"Map legend information",onClick:()=>alert("Map Legend:\n• Blue Pin: Your Location\n• Red: Ongoing Events\n• Gray: Past Events\n• Green: Today's Upcoming\n• Purple: Future Events"),children:(0,i.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-5 h-5 text-white",children:(0,i.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m11.25 11.25.041-.02a.75.75 0 0 1 1.063.852l-.708 2.836a.75.75 0 0 0 1.063.853l.041-.021M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-9-3.75h.008v.008H12V8.25Z"})})})})]})}var u=()=>(0,i.jsxs)("div",{className:"flex items-center justify-center h-screen",children:[(0,i.jsx)("svg",{className:"animate-spin h-10 w-10 text-zinc-400",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"24",height:"24",color:"#000000",fill:"none",children:(0,i.jsx)("path",{d:"M18.001 20C16.3295 21.2558 14.2516 22 12 22C6.47715 22 2 17.5228 2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 12.8634 21.8906 13.7011 21.6849 14.5003C21.4617 15.3673 20.5145 15.77 19.6699 15.4728C18.9519 15.2201 18.6221 14.3997 18.802 13.66C18.9314 13.1279 19 12.572 19 12C19 8.13401 15.866 5 12 5C8.13401 5 5 8.13401 5 12C5 15.866 8.13401 19 12 19C13.3197 19 14.554 18.6348 15.6076 18",fill:"currentColor","stroke-width":"1.5","stroke-linecap":"round"})}),(0,i.jsx)("p",{className:"ml-4 text-zinc-400",children:"Loading..."})]}),p=s(4351),h=s(810),g=s(8900),f=s(8882),v=s(9489);function w(e){let{isOpen:t,onClose:s,onPasswordVerified:n,eventId:r}=e,[o,c]=(0,l.useState)(""),[d,m]=(0,l.useState)(""),[x,u]=(0,l.useState)(!1),p=async e=>{e.preventDefault(),m(""),u(!0);try{let{data:e,error:t}=await a.from("events").select("password").eq("id",r).single();if(t)throw console.error("Fetch Error:",t),Error("Failed to fetch event");if(!e)throw Error("Event not found");e.password===o?(n(),s()):m("Incorrect password")}catch(e){m(e instanceof Error?e.message:"Failed to verify password"),console.error("Error:",e)}finally{u(!1)}};return t?(0,i.jsx)("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-[600] flex items-center justify-center",children:(0,i.jsxs)("div",{className:"bg-zinc-900 rounded-lg p-6 w-[90%] max-w-md",children:[(0,i.jsx)("h2",{className:"text-lg font-semibold text-white mb-4",children:"Verify Event Password"}),(0,i.jsxs)("form",{onSubmit:p,className:"space-y-4",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"block text-sm font-medium text-zinc-400 mb-1",children:"Password"}),(0,i.jsx)("input",{type:"password",value:o,onChange:e=>c(e.target.value),className:"w-full bg-zinc-800 rounded-lg px-3 py-2 text-white focus:outline-none focus:ring-2 focus:ring-red-500",placeholder:"Enter event password",required:!0}),d&&(0,i.jsx)("p",{className:"text-red-500 text-sm mt-1",children:d})]}),(0,i.jsxs)("div",{className:"flex justify-end gap-3",children:[(0,i.jsx)("button",{type:"button",onClick:s,className:"px-3 py-1.5 text-sm text-zinc-400 hover:text-white transition-colors",children:"Cancel"}),(0,i.jsx)("button",{type:"submit",disabled:x,className:"bg-red-500 hover:bg-red-600 disabled:bg-red-400 text-white px-4 py-1.5 rounded-lg text-sm font-medium transition-colors flex items-center gap-2",children:x?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("svg",{className:"animate-spin h-4 w-4",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,i.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,i.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Verifying..."]}):"Verify"})]})]})]})}):null}var b=s(9343);function j(e){try{console.log("Extracting coordinates from URL:",e);let s={latitude:0,longitude:0},i=new URL(e);if(e.includes("maps.app.goo.gl")){var t;let i=e.split("@");console.log("URL parts:",i);let l=null===(t=i[1])||void 0===t?void 0:t.split(",");if(l&&l.length>=2)return s.latitude=parseFloat(l[0]),s.longitude=parseFloat(l[1]),console.log("Extracted coordinates:",s),s}if(e.includes("google.com/maps")){let t=e.match(/@(-?\d+\.\d+),(-?\d+\.\d+)/);if(t)return s.latitude=parseFloat(t[1]),s.longitude=parseFloat(t[2]),s;let l=new URLSearchParams(i.search).get("q");if(l){let e=l.match(/(-?\d+\.\d+),(-?\d+\.\d+)/);if(e)return s.latitude=parseFloat(e[1]),s.longitude=parseFloat(e[2]),s}}return console.log("No coordinates found in URL"),null}catch(e){return console.error("Error extracting coordinates:",e),null}}function N(e){var t,s,n,r,o,c;let{onEventAdded:d,onFormVisibilityChange:x,editMode:u=!1,eventData:p,onClose:h}=e,[g,f]=(0,l.useState)(u),[v,w]=(0,l.useState)(!1),[N,y]=(0,l.useState)(u&&p?p.image_url:null),{register:z,handleSubmit:k,formState:{errors:_},reset:E,watch:C,setValue:S}=(0,b.cI)({defaultValues:u&&p?{title:p.title,description:p.description,email:p.email,date:p.date,startTime:p.startTime||"",endTime:p.endTime||"",location:p.location,organizerName:p.organizer_name,event_type:p.event_type,max_participants:p.max_participants,rsvp_link:p.rsvp_link,password:p.password}:void 0}),T=C("image");(0,l.useEffect)(()=>{if(null==T?void 0:T[0]){let e=new FileReader;e.onloadend=()=>{y(e.result)},e.readAsDataURL(T[0])}else y(null)},[T]),(0,l.useEffect)(()=>{null==x||x(g)},[g,x]),(0,l.useEffect)(()=>(g?document.body.style.overflow="hidden":document.body.style.overflow="auto",()=>{document.body.style.overflow="auto"}),[g]);let L=async e=>{w(!0);try{var t,s;let i="";if(null===(t=e.image)||void 0===t?void 0:t[0]){let t=await m(e.image[0]),s=t.name.replace(/[^a-zA-Z0-9.]/g,"_").replace(/__+/g,"_"),l="".concat(Date.now(),"-").concat(s),{error:n,data:r}=await a.storage.from("event-images").upload(l,t);if(n)throw console.error("Upload Error:",n),n;let{data:o}=a.storage.from("event-images").getPublicUrl(l);if(!(i=null==o?void 0:o.publicUrl))throw Error("Failed to get public URL")}let l=e.date,n=e.startTime,r=e.endTime;if(!Array.isArray(e.event_type)||0===e.event_type.length)throw Error("Please select at least one event type");let o=parseInt(e.max_participants.toString(),10);if(isNaN(o)||o<=0)throw Error("Max participants must be a positive number");let c=j(e.location);if(c&&(c.latitude||c.longitude)||console.warn("Could not extract coordinates from location URL:",e.location),u&&(null==p?void 0:p.id)){let{error:t}=await a.from("events").update({title:e.title,description:e.description,email:e.email,date:l,startTime:n,endTime:r,location:e.location,...(null===(s=e.image)||void 0===s?void 0:s[0])?{image_url:i}:{},organizer_name:e.organizerName,event_type:e.event_type,max_participants:o,rsvp_link:e.rsvp_link,password:e.password,...c}).eq("id",p.id);if(t)throw t}else{let t={title:e.title,description:e.description,email:e.email,date:l,startTime:n,endTime:r,location:e.location,image_url:i,organizer_name:e.organizerName,event_type:e.event_type,max_participants:o,current_participants:0,rsvp_link:e.rsvp_link,password:e.password,...c};console.log("Creating new event with data:",t);let{error:s}=await a.from("events").insert(t);if(s)throw console.error("Insert Error:",s),s}d(),u&&h?h():f(!1),E(),y(null)}catch(t){console.error("Full error details:",t);let e="An unknown error occurred";t instanceof Error&&(e=t.message),"object"==typeof t&&null!==t&&t.message&&((e=t.message).includes("InvalidKey")?e="Invalid file name. Please rename your file and try again.":e.includes("Permission denied")?e="You do not have permission to upload files.":e.includes("violates foreign key constraint")&&(e="Unable to save event due to database constraints.")),alert("Failed to create event: ".concat(e))}finally{w(!1)}};return(0,i.jsxs)("div",{className:"z-10",children:[!u&&(0,i.jsxs)("button",{onClick:()=>f(!0),className:"flex items-center justify-center gap-1.5 bg-orange-500 hover:bg-orange-600 text-white p-2 rounded-lg font-medium transition-colors",children:[(0,i.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,i.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),"Add"]}),g&&(0,i.jsx)("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-[500]",children:(0,i.jsxs)("div",{className:"fixed right-0 top-0 h-full w-[94%] sm:w-[500px] bg-zinc-900 overflow-y-auto",children:[(0,i.jsxs)("div",{className:"sticky top-0 z-10 flex justify-between items-center p-4 sm:p-6 bg-zinc-900 border-b border-zinc-800",children:[(0,i.jsx)("h2",{className:"text-base sm:text-lg font-semibold text-white",children:"Add New Event"}),(0,i.jsx)("button",{onClick:()=>f(!1),className:"text-zinc-400 hover:text-white transition-colors",children:(0,i.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,i.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,i.jsxs)("form",{onSubmit:k(L),className:"p-4 sm:p-6",children:[(0,i.jsxs)("div",{className:"space-y-4",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"block text-xs sm:text-sm font-medium text-zinc-400 mb-1",children:"Event Title"}),(0,i.jsx)("input",{...z("title",{required:"Title is required",maxLength:{value:60,message:"Title must be less than 60 characters"}}),placeholder:"e.g., Math Study Group Session",className:"w-full bg-zinc-800 rounded-lg px-3 sm:px-4 py-1.5 sm:py-2 text-sm sm:text-base text-white focus:outline-none focus:ring-2 focus:ring-red-500 placeholder:text-zinc-500"}),(0,i.jsxs)("div",{className:"flex justify-between items-center mt-1",children:[_.title&&(0,i.jsx)("p",{className:"text-red-500 text-xs sm:text-sm",children:_.title.message}),(0,i.jsxs)("span",{className:"text-zinc-400 text-xs",children:[(null===(t=C("title"))||void 0===t?void 0:t.length)||0,"/60"]})]})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"block text-xs sm:text-sm font-medium text-zinc-400 mb-1",children:"Description"}),(0,i.jsx)("textarea",{...z("description",{required:"Description is required",maxLength:{value:250,message:"Description must be less than 250 characters"}}),placeholder:"e.g., Join us for a collaborative study session covering calculus topics...",className:"w-full bg-zinc-800 rounded-lg px-3 sm:px-4 py-1.5 sm:py-2 text-sm sm:text-base text-white focus:outline-none focus:ring-2 focus:ring-red-500 h-24 resize-none placeholder:text-zinc-500"}),(0,i.jsxs)("div",{className:"flex justify-between items-center mt-1",children:[_.description&&(0,i.jsx)("p",{className:"text-red-500 text-xs sm:text-sm",children:_.description.message}),(0,i.jsxs)("span",{className:"text-zinc-400 text-xs",children:[(null===(s=C("description"))||void 0===s?void 0:s.length)||0,"/250"]})]})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"block text-xs sm:text-sm font-medium text-zinc-400 mb-1",children:"Event Type"}),(0,i.jsx)("div",{className:"space-y-2 bg-zinc-800 rounded-lg px-3 sm:px-4 py-2",children:["Study Group","Social","Sports","Academic","Other"].map(e=>(0,i.jsxs)("label",{className:"flex items-center space-x-2 cursor-pointer",children:[(0,i.jsx)("input",{type:"checkbox",value:e,...z("event_type",{required:"Please select at least one event type"}),className:"rounded bg-zinc-700 border-zinc-600 text-red-500 focus:ring-red-500"}),(0,i.jsx)("span",{className:"text-sm text-white",children:e})]},e))}),_.event_type&&(0,i.jsx)("p",{className:"text-red-500 text-xs sm:text-sm mt-1",children:_.event_type.message})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"block text-xs sm:text-sm font-medium text-zinc-400 mb-1",children:"Max Participants"}),(0,i.jsx)("input",{type:"number",min:"1",...z("max_participants",{required:"Max participants is required",min:{value:1,message:"Must be at least 1"}}),placeholder:"e.g., 20",className:"w-full bg-zinc-800 rounded-lg px-3 sm:px-4 py-1.5 sm:py-2 text-sm sm:text-base text-white focus:outline-none focus:ring-2 focus:ring-red-500"}),_.max_participants&&(0,i.jsx)("p",{className:"text-red-500 text-xs sm:text-sm mt-1",children:_.max_participants.message})]}),(0,i.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"block text-xs sm:text-sm font-medium text-zinc-400 mb-1",children:"Date"}),(0,i.jsx)("input",{type:"date",min:new Date().toLocaleDateString("en-CA"),...z("date",{required:"Date is required"}),className:"w-full bg-zinc-800 rounded-lg px-3 sm:px-4 py-1.5 sm:py-2 text-sm sm:text-base text-white focus:outline-none focus:ring-2 focus:ring-red-500"}),_.date&&(0,i.jsx)("p",{className:"text-red-500 text-xs sm:text-sm mt-1",children:_.date.message})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"block text-xs sm:text-sm font-medium text-zinc-400 mb-1",children:"Time"}),(0,i.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,i.jsx)("input",{type:"time",...z("startTime",{required:"Start time required"}),className:"w-full bg-zinc-800 rounded-lg px-3 sm:px-4 py-1.5 sm:py-2 text-sm sm:text-base text-white focus:outline-none focus:ring-2 focus:ring-red-500"}),(0,i.jsx)("input",{type:"time",...z("endTime",{required:"End time required"}),className:"w-full bg-zinc-800 rounded-lg px-3 sm:px-4 py-1.5 sm:py-2 text-sm sm:text-base text-white focus:outline-none focus:ring-2 focus:ring-red-500"})]}),(_.startTime||_.endTime)&&(0,i.jsx)("p",{className:"text-red-500 text-xs sm:text-sm mt-1",children:(null===(n=_.startTime)||void 0===n?void 0:n.message)||(null===(r=_.endTime)||void 0===r?void 0:r.message)})]})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"block text-xs sm:text-sm font-medium text-zinc-400 mb-1",children:"Location URL"}),(0,i.jsx)("input",{...z("location",{required:"Location URL is required"}),placeholder:"e.g., https://goo.gl/maps/...",className:"w-full bg-zinc-800 rounded-lg px-3 sm:px-4 py-1.5 sm:py-2 text-sm sm:text-base text-white focus:outline-none focus:ring-2 focus:ring-red-500"}),_.location&&(0,i.jsx)("p",{className:"text-red-500 text-xs sm:text-sm mt-1",children:_.location.message})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"block text-xs sm:text-sm font-medium text-zinc-400 mb-1",children:"RSVP Link"}),(0,i.jsx)("input",{...z("rsvp_link",{required:"RSVP link is required"}),placeholder:"e.g., https://forms.google.com/...",className:"w-full bg-zinc-800 rounded-lg px-3 sm:px-4 py-1.5 sm:py-2 text-sm sm:text-base text-white focus:outline-none focus:ring-2 focus:ring-red-500"}),_.rsvp_link&&(0,i.jsx)("p",{className:"text-red-500 text-xs sm:text-sm mt-1",children:_.rsvp_link.message})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"block text-xs sm:text-sm font-medium text-zinc-400 mb-1",children:"Organizer Email (.edu)"}),(0,i.jsx)("input",{type:"email",...z("email",{required:"Email is required",validate:e=>e.endsWith(".edu")||"Only .edu email addresses are allowed"}),placeholder:"e.g., student@university.edu",className:"w-full bg-zinc-800 rounded-lg px-3 sm:px-4 py-1.5 sm:py-2 text-sm sm:text-base text-white focus:outline-none focus:ring-2 focus:ring-red-500"}),_.email&&(0,i.jsx)("p",{className:"text-red-500 text-xs sm:text-sm mt-1",children:_.email.message})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"block text-xs sm:text-sm font-medium text-zinc-400 mb-1",children:"Organizer Name"}),(0,i.jsx)("input",{...z("organizerName",{required:"Organizer name is required"}),placeholder:"e.g., John Doe",className:"w-full bg-zinc-800 rounded-lg px-3 sm:px-4 py-1.5 sm:py-2 text-sm sm:text-base text-white focus:outline-none focus:ring-2 focus:ring-red-500"}),_.organizerName&&(0,i.jsx)("p",{className:"text-red-500 text-xs sm:text-sm mt-1",children:_.organizerName.message})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"block text-xs sm:text-sm font-medium text-zinc-400 mb-1",children:"Event Password"}),(0,i.jsx)("input",{type:"password",...z("password",{required:"Password is required",minLength:{value:6,message:"Password must be at least 6 characters"}}),placeholder:"Enter a password to protect your event",className:"w-full bg-zinc-800 rounded-lg px-3 sm:px-4 py-1.5 sm:py-2 text-sm sm:text-base text-white focus:outline-none focus:ring-2 focus:ring-red-500"}),_.password&&(0,i.jsx)("p",{className:"text-red-500 text-xs sm:text-sm mt-1",children:_.password.message})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"block text-xs sm:text-sm font-medium text-zinc-400 mb-1",children:"Event Image"}),(0,i.jsx)("div",{className:"mt-1 flex justify-center px-4 py-6 border-2 border-zinc-700 border-dashed rounded-lg hover:border-zinc-500 transition-colors",children:(0,i.jsx)("div",{className:"space-y-2 text-center",children:N?(0,i.jsxs)("div",{className:"space-y-3",children:[(0,i.jsx)("img",{src:N,alt:"Preview",className:"max-h-32 mx-auto rounded-lg object-contain"}),(0,i.jsx)("p",{className:"text-xs text-zinc-400 truncate max-w-[200px] mx-auto",children:null==T?void 0:null===(o=T[0])||void 0===o?void 0:o.name}),(0,i.jsx)("button",{type:"button",onClick:()=>{S("image",void 0),y(null)},className:"text-xs text-red-400 hover:text-red-300 transition-colors",children:"Remove Image"})]}):(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("svg",{className:"mx-auto h-12 w-12 text-zinc-400",stroke:"currentColor",fill:"none",viewBox:"0 0 48 48",children:(0,i.jsx)("path",{d:"M28 8H12a4 4 0 00-4 4v20m32-12v8m0 0v8a4 4 0 01-4 4H12a4 4 0 01-4-4v-4m32-4l-3.172-3.172a4 4 0 00-5.656 0L28 28M8 32l9.172-9.172a4 4 0 015.656 0L28 28m0 0l4 4m4-24h8m-4-4v8m-12 4h.02",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})}),(0,i.jsxs)("div",{className:"flex text-sm text-zinc-400",children:[(0,i.jsxs)("label",{htmlFor:"file-upload",className:"relative cursor-pointer rounded-md font-medium text-red-500 hover:text-red-400 focus-within:outline-none",children:[(0,i.jsx)("span",{children:"Upload a file"}),(0,i.jsx)("input",{id:"file-upload",type:"file",accept:"image/*",className:"sr-only",...z("image")})]}),(0,i.jsx)("p",{className:"pl-1",children:"or drag and drop"})]}),(0,i.jsx)("p",{className:"text-xs text-zinc-500",children:"PNG, JPG, GIF up to 5MB"})]})})}),_.image&&(0,i.jsx)("p",{className:"text-red-500 text-xs sm:text-sm mt-1",children:null===(c=_.image.message)||void 0===c?void 0:c.toString()})]})]}),(0,i.jsxs)("div",{className:"flex justify-end gap-2 sm:gap-3 mt-6 pt-4 border-t border-zinc-800",children:[(0,i.jsx)("button",{type:"button",onClick:()=>f(!1),className:"px-3 py-2 text-sm text-zinc-400 hover:text-white transition-colors",children:"Cancel"}),(0,i.jsx)("button",{type:"submit",disabled:v,className:"bg-red-500 hover:bg-red-600 disabled:bg-red-400 text-white px-4 py-2 rounded-lg font-medium transition-colors text-sm flex items-center gap-2",children:v?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("svg",{className:"animate-spin h-4 w-4",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,i.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,i.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),u?"Saving...":"Creating..."]}):u?"Save Changes":"Create Event"})]})]})]})})]})}function y(e){let{event:t,isSelected:s,onClick:a,onEdit:n}=e;console.log("Event RSVP link:",t.id,t.rsvp_link);let[r,o]=(0,l.useState)(!1),[c,m]=(0,l.useState)(!1),[x,u]=(0,l.useState)(!1),b=(0,l.useRef)(null),j=(0,l.useCallback)(()=>{o(!0),u(!1)},[]),y=(0,l.useCallback)(()=>{o(!1),m(!0)},[]),z=(0,l.useCallback)(()=>{m(!1),n&&n()},[n]),k=(0,l.useCallback)(()=>!!t.rsvp_link&&""!==t.rsvp_link&&"#"!==t.rsvp_link,[t.rsvp_link]),_=(0,l.useCallback)(()=>{let e={title:t.title,text:"Check out this event: ".concat(t.title).concat(t.description?" - ".concat(t.description):""),url:window.location.href};navigator.share?navigator.share(e).then(()=>{console.log("Event shared successfully")}).catch(e=>{console.error("Error sharing event:",e)}):alert("Sharing is not supported in your browser"),u(!1)},[t.title,t.description]);return(0,l.useEffect)(()=>{function e(e){b.current&&!b.current.contains(e.target)&&u(!1)}return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[]),(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("div",{className:"flex overflow-hidden bg-zinc-800 rounded-xl cursor-pointer transition-all w-full sm:w-full md:w-full lg:w-[404px] h-auto min-h-[150px] lg:h-[202px] ".concat(s?"ring-2 ring-orange-500 shadow-lg":"hover:bg-zinc-700/50"),onClick:a,children:[(0,i.jsx)("div",{className:"w-1/3 sm:w-1/3 md:w-5/12 lg:w-1/2 aspect-square relative",children:t.image_url?(0,i.jsx)("img",{src:t.image_url,alt:t.title||"Event",className:"h-full w-full object-cover"}):(0,i.jsx)("div",{className:"h-full w-full bg-gradient-to-br from-orange-500/30 to-purple-500/30 flex items-center justify-center",children:(0,i.jsx)(p.Z,{className:"h-8 w-8 sm:h-10 sm:w-10 md:h-12 md:w-12 text-zinc-400"})})}),(0,i.jsxs)("div",{className:"flex flex-col w-2/3 sm:w-2/3 md:w-7/12 lg:w-1/2 p-2 sm:p-3",children:[(0,i.jsxs)("div",{className:"flex justify-between items-start relative",children:[(0,i.jsx)("h3",{className:"text-base sm:text-lg font-semibold text-white mb-1 truncate pr-2",children:t.title}),(0,i.jsx)("button",{className:"p-1 rounded hover:bg-zinc-700",onClick:e=>{e.stopPropagation(),u(!x)},children:(0,i.jsx)(h.Z,{className:"h-4 w-4 sm:h-5 sm:w-5 text-zinc-500 flex-shrink-0"})}),x&&(0,i.jsxs)("div",{ref:b,className:"absolute right-0 top-7 sm:top-8 w-36 sm:w-40 bg-zinc-800 border border-zinc-700 rounded-md shadow-lg z-10",children:[(0,i.jsxs)("div",{className:"px-3 sm:px-4 py-2 text-white text-xs sm:text-sm cursor-pointer hover:bg-zinc-700 flex items-center",onClick:e=>{e.stopPropagation(),j()},children:[(0,i.jsx)(g.Z,{className:"h-3 w-3 sm:h-4 sm:w-4 mr-2"}),"Edit Event"]}),(0,i.jsxs)("div",{className:"px-3 sm:px-4 py-2 text-white text-xs sm:text-sm cursor-pointer hover:bg-zinc-700 flex items-center border-t border-zinc-700",onClick:e=>{e.stopPropagation(),_()},children:[(0,i.jsx)(f.Z,{className:"h-3 w-3 sm:h-4 sm:w-4 mr-2"}),"Share Event"]})]})]}),t.description&&(0,i.jsx)("p",{className:"text-xs sm:text-sm text-zinc-300 line-clamp-2 mb-auto w-full",children:t.description}),(t.startTime||t.endTime)&&(0,i.jsx)("div",{className:"text-xs sm:text-sm text-zinc-400 mb-1 sm:mb-2 w-full",children:(0,i.jsxs)("div",{className:"flex items-start",children:[(0,i.jsx)("span",{className:"font-medium",children:"Time:"}),(0,i.jsxs)("span",{className:"truncate ml-1",children:[t.startTime&&d(t.startTime),t.endTime&&" - ".concat(d(t.endTime))]})]})}),(0,i.jsxs)("div",{className:"flex items-center gap-1 sm:gap-2 mt-auto",children:[(0,i.jsx)("button",{className:"flex items-center justify-center px-2 sm:px-4 py-1 sm:py-1.5 rounded-full bg-zinc-700 text-white text-xs sm:text-sm font-medium",onClick:e=>{e.stopPropagation(),k()?window.open(t.rsvp_link,"_blank"):alert("No RSVP link available for this event.")},children:"RSVP"}),(0,i.jsx)("button",{className:"flex items-center justify-center rounded-full bg-zinc-700 p-1.5 sm:p-2",onClick:e=>{e.stopPropagation(),t.location&&window.open("https://maps.google.com/?q=".concat(t.location),"_blank")},title:"View Location",children:(0,i.jsx)(v.Z,{className:"h-3 w-3 sm:h-4 sm:w-4 text-white"})}),(0,i.jsx)("button",{className:"flex items-center justify-center rounded-full bg-zinc-700 p-1.5 sm:p-2",onClick:e=>{if(e.stopPropagation(),t.date&&t.startTime&&t.endTime){let e="".concat(t.date,"T").concat(t.startTime),s="".concat(t.date,"T").concat(t.endTime),i="https://calendar.google.com/calendar/render?action=TEMPLATE&text=".concat(encodeURIComponent(t.title),"&dates=").concat(e.replace(/[-:]/g,""),"/").concat(s.replace(/[-:]/g,""),"&details=").concat(encodeURIComponent(t.description||""),"&location=").concat(encodeURIComponent(t.location||""));window.open(i,"_blank")}},title:"Add to Calendar",children:(0,i.jsx)(p.Z,{className:"h-3 w-3 sm:h-4 sm:w-4 text-white"})})]})]})]}),r&&(0,i.jsx)(w,{isOpen:r,onClose:()=>o(!1),onPasswordVerified:y,eventId:t.id||""}),c&&(0,i.jsx)(N,{eventData:t,onEventAdded:z,onClose:z,editMode:!0})]})}var z=s(4694);let k=z.fC,_=z.xz;z.ee;let E=l.forwardRef((e,t)=>{let{className:s,align:l="center",sideOffset:a=4,...n}=e;return(0,i.jsx)(z.h_,{children:(0,i.jsx)(z.VY,{ref:t,align:l,sideOffset:a,className:function(){for(var e=arguments.length,t=Array(e),s=0;s<e;s++)t[s]=arguments[s];return(0,c.m6)((0,o.W)(t))}("z-50 w-72 rounded-md border border-zinc-200 bg-white p-4 text-zinc-950 shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 dark:border-zinc-800 dark:bg-zinc-950 dark:text-zinc-50",s),...n})})});E.displayName=z.VY.displayName;var C=s(1604),S=s(9808),T=s(4380),L=s(1961),D=s(8906),q=s(8357),P=s(4573),I=s(6505);s(9837);var M=s(6648);function R(e){let{events:t,selectedEvent:s,onEventSelect:n,onEventAdded:r,onEventUpdated:o,onDateSelect:c}=e,d=["Study Group","Social","Sports","Academic","Other"],[m,x]=(0,l.useState)(!0),[u,p]=(0,l.useState)(d),[h,g]=(0,l.useState)(""),f=(0,l.useRef)(null),[v,w]=(0,l.useState)(null),[N,z]=(0,l.useState)(!1),[R,A]=(0,l.useState)(!1),[F,U]=(0,l.useState)(!1),[Z,V]=(0,l.useState)(null),[O,B]=(0,l.useState)(!1),[W,H]=(0,l.useState)({unit:"%",width:100,height:100,x:0,y:0}),[G,Y]=(0,l.useState)(null),J=(0,l.useRef)(null),[X,Q]=(0,l.useState)(null),[K,$]=(0,l.useState)(null),ee=new Date;ee.setHours(0,0,0,0);let[et,es]=(0,l.useState)(ee),[ei,el]=(0,l.useState)(ee),{register:ea,handleSubmit:en,formState:{errors:er},reset:eo,watch:ec,setValue:ed}=(0,b.cI)(),em=ec("image");(0,l.useEffect)(()=>{if(null==em?void 0:em[0]){let e=em[0];$(e);let t=new FileReader;t.onloadend=()=>{V(t.result),H({unit:"%",width:80,height:45,x:10,y:20}),B(!0)},t.readAsDataURL(e),ed("image",void 0)}},[em,ed]);let ex=(0,l.useCallback)(async()=>{if(!J.current||!G||!K)return;let e=J.current,t=document.createElement("canvas"),s=e.naturalWidth/e.width,i=e.naturalHeight/e.height,l=t.getContext("2d");if(l)return t.width=G.width*s,t.height=G.height*i,l.imageSmoothingEnabled=!0,l.imageSmoothingQuality="high",l.drawImage(e,G.x*s,G.y*i,G.width*s,G.height*i,0,0,t.width,t.height),new Promise((e,s)=>{t.toBlob(t=>{if(!t||!K){s(Error("Failed to create blob"));return}let i=new File([t],K.name,{type:K.type,lastModified:Date.now()}),l=new FileReader;l.onloadend=()=>{Q(l.result)},l.readAsDataURL(t),e(i)},K.type,.95)})},[G,K]),eu=(0,l.useCallback)(e=>{Y(e)},[]),ep=(0,l.useCallback)(async()=>{try{let e=await ex();e&&($(e),B(!1))}catch(e){console.error("Error cropping image:",e)}},[ex]),eh=async e=>{U(!0);try{let t="";if(K){let e="".concat(Date.now(),"-").concat(K.name.replace(/[^a-zA-Z0-9.]/g,"_").replace(/__+/g,"_")),{error:s,data:i}=await a.storage.from("event-images").upload(e,K);if(s)throw s;let{data:l}=a.storage.from("event-images").getPublicUrl(e);t=(null==l?void 0:l.publicUrl)||""}if(!Array.isArray(e.event_type)||0===e.event_type.length)throw Error("Please select at least one event type");let s=parseInt(e.max_participants.toString(),10);if(isNaN(s)||s<=0)throw Error("Max participants must be a positive number");let i=j(e.location),l={title:e.title,description:e.description,email:e.email,date:e.date,startTime:e.startTime,endTime:e.endTime,location:e.location,image_url:t,organizer_name:e.organizerName,event_type:e.event_type,max_participants:s,current_participants:0,rsvp_link:e.rsvp_link,password:e.password,...i},{error:n}=await a.from("events").insert(l);if(n)throw n;r(),A(!1),eo(),V(null),Q(null),$(null),B(!1)}catch(t){console.error("Error adding event:",t);let e="An unknown error occurred";t instanceof Error&&(e=t.message),alert("Failed to create event: ".concat(e))}finally{U(!1)}},eg=e=>{e>=ee&&(es(e),c&&c(e))},ef=()=>{let e=new Date(ee);return e.setDate(ee.getDate()+1),ei.getTime()===ee.getTime()||ei.getTime()<=e.getTime()},ev=e=>{if("All"===e){let e=!m;x(e),e?p(d):p([]);return}p(t=>{let s;return x((s=t.includes(e)?t.filter(t=>t!==e):[...t,e]).length===d.length),s})},ew=t.filter(e=>!!m||0!==u.length&&(Array.isArray(e.event_type)?e.event_type.some(e=>u.includes(e)):u.includes(e.event_type))).filter(e=>{if(h.trim()){var t,s,i;let l=h.toLowerCase().trim();return(null===(t=e.title)||void 0===t?void 0:t.toLowerCase().includes(l))||(null===(s=e.description)||void 0===s?void 0:s.toLowerCase().includes(l))||(null===(i=e.location)||void 0===i?void 0:i.toLowerCase().includes(l))}return!0});(0,l.useEffect)(()=>{s&&f.current&&f.current.scrollIntoView({behavior:"smooth",block:"center"})},[s]);let eb=(()=>{let e=[],t=new Date(ei);ei.getTime()===ee.getTime()&&(t=new Date(ee)).setDate(ee.getDate()+1);for(let s=0;s<3;s++){let i=new Date(t);i.setDate(t.getDate()+s),e.push(i)}return e})(),ej=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],eN=e=>e.toDateString()===et.toDateString(),[ey,ez]=(0,l.useState)("Search events...");return(0,l.useEffect)(()=>{let e=()=>{window.innerWidth>=1024&&window.innerWidth<=1635?ez("Search..."):ez("Search events...")};return e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]),(0,i.jsxs)("div",{className:"flex flex-col h-full overflow-hidden space-y-3",children:[(0,i.jsxs)("div",{className:"bg-orange-500 rounded-3xl p-3 sm:p-5 flex-shrink-0 w-full sm:w-full md:w-full lg:w-[434px] h-auto lg:h-[115px]",children:[(0,i.jsxs)("h1",{className:"text-xl sm:text-2xl font-bold text-white flex items-center justify-center md:justify-start cursor-pointer",onClick:()=>window.location.reload(),children:["E V",(0,i.jsx)("span",{className:"inline-flex items-center mx-1",children:(0,i.jsx)(M.default,{src:"/Images/png.png",alt:"Ə",width:25,height:25,className:"object-contain",priority:!0})}),"N T S"]}),(0,i.jsx)("div",{className:"flex items-center justify-center md:justify-start mt-3 sm:mt-4",children:(0,i.jsx)("div",{className:"bg-black rounded-[20px] w-full max-w-full sm:max-w-full md:max-w-full lg:w-[397px] h-[40px] flex items-center p-1",children:(0,i.jsxs)("div",{className:"flex items-center",children:[(0,i.jsx)("button",{className:"".concat(eN(ee)?"bg-white text-black":"text-white"," rounded-full h-[32px] px-3 sm:px-4 md:px-6 lg:px-4 xl:px-5 font-medium text-xs sm:text-sm lg:text-sm xl:text-base flex-shrink-0 mr-2"),onClick:()=>{es(ee),c&&c(ee)},children:"Today"}),(0,i.jsxs)("div",{className:"flex items-center",children:[(0,i.jsx)("button",{className:"p-1.5 sm:p-2 lg:p-1.5 xl:p-1.5 2xl:p-2 ".concat(ef()?"bg-zinc-700 text-gray-500 cursor-not-allowed":"bg-zinc-800 text-white cursor-pointer hover:bg-orange-500"," rounded-full transition-colors flex-shrink-0"),onClick:()=>{let e=new Date(ee);if(e.setDate(ee.getDate()+1),ei.getTime()<=e.getTime())el(ee);else{let e=new Date(ei);e.setDate(ei.getDate()-5),e<ee?el(ee):el(e)}},disabled:ef(),"aria-label":"Previous days",children:(0,i.jsx)(C.Z,{className:"w-4 h-4 sm:w-5 sm:h-5 lg:w-4 lg:h-4 xl:w-4 xl:h-4 2xl:w-5 2xl:h-5"})}),(0,i.jsx)("div",{className:"flex space-x-2 sm:space-x-3 md:space-x-2 lg:space-x-[0.15rem] xl:space-x-3 2xl:space-x-4 px-1 sm:px-2 md:px-1 lg:px-1 xl:px-2 2xl:px-3 max-w-[180px] sm:max-w-[230px] md:max-w-[300px] lg:max-w-[220px] xl:max-w-[350px] 2xl:max-w-[450px] overflow-x-auto",children:eb.map((e,t)=>(0,i.jsxs)("div",{className:"relative flex flex-col items-center justify-center w-9 sm:w-11 md:w-12 lg:w-[26px] xl:w-10 2xl:w-14 h-12 sm:h-14 md:h-16 lg:h-14 ".concat(e>=ee?"cursor-pointer":"opacity-50 cursor-not-allowed"),onClick:()=>e>=ee&&eg(e),children:[eN(e)&&(0,i.jsx)("div",{className:"absolute inset-[7px] bg-white rounded-full",style:{zIndex:0}}),(0,i.jsxs)("div",{className:"flex flex-col items-center justify-center relative z-10",children:[(0,i.jsx)("div",{className:"".concat(eN(e)?"text-black":"text-white"," font-medium text-sm sm:text-base md:text-lg lg:text-xs xl:text-sm 2xl:text-base"),children:e.getDate()}),(0,i.jsx)("div",{className:"".concat(eN(e)?"text-zinc-600":"text-gray-400"," text-[10px] sm:text-xs lg:text-[8px] xl:text-[9px] 2xl:text-xs"),children:ej[e.getDay()]})]})]},t))}),(0,i.jsx)("button",{className:"p-1.5 sm:p-2 lg:p-1.5 xl:p-1.5 2xl:p-2 bg-zinc-800 rounded-full hover:bg-orange-500 text-white cursor-pointer transition-colors flex-shrink-0",onClick:()=>{let e=new Date(ei);e.setDate(ei.getDate()+5),el(e)},"aria-label":"Next days",children:(0,i.jsx)(S.Z,{className:"w-4 h-4 sm:w-5 sm:h-5 lg:w-4 lg:h-4 xl:w-4 xl:h-4 2xl:w-5 2xl:h-5"})})]})]})})})]}),(0,i.jsxs)("div",{className:"bg-zinc-900 rounded-3xl flex-1 overflow-hidden flex flex-col w-full sm:w-full md:w-full lg:w-[435px] h-auto lg:h-[799px]",children:[(0,i.jsx)("div",{className:"flex flex-col sm:flex-row sm:items-center justify-center md:justify-start p-3 sm:p-4 gap-2 sm:gap-0 flex-shrink-0",children:(0,i.jsxs)("div",{className:"flex items-center space-x-1 sm:space-x-2 md:space-x-3 xl:space-x-4 flex-wrap sm:flex-nowrap w-full lg:w-[397px]",children:[(0,i.jsxs)("div",{className:"relative",children:[(0,i.jsx)("input",{type:"text",placeholder:ey,value:h,onChange:e=>g(e.target.value),className:"w-[157px] h-[39px] bg-zinc-800 text-white text-sm rounded-full pl-8 pr-3 py-2 placeholder-white focus:outline-none focus:ring-1 focus:ring-orange-500"}),(0,i.jsx)(T.Z,{className:"absolute left-2.5 top-1/2 -translate-y-1/2 w-4 h-4 text-white"})]}),(0,i.jsxs)(k,{children:[(0,i.jsx)(_,{asChild:!0,children:(0,i.jsxs)("button",{className:"flex items-center justify-center gap-1 sm:gap-2 px-2 sm:px-3 md:px-4 lg:px-3 xl:px-3 2xl:px-4 py-1.5 sm:py-2 rounded-full bg-orange-500 h-[32px] sm:h-[38px] lg:h-[40px] flex-shrink-0",onClick:()=>z(!N),children:[(0,i.jsx)(L.Z,{className:"w-4 h-4 sm:w-5 sm:h-5 text-white"}),(0,i.jsx)(D.Z,{className:"w-4 h-4 sm:w-5 sm:h-5 text-white hidden sm:block"})]})}),(0,i.jsx)(E,{className:"w-auto bg-zinc-800 border-zinc-700",align:"end",children:(0,i.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,i.jsxs)("label",{className:"flex items-center space-x-2 cursor-pointer border-b border-zinc-700 pb-2",children:[(0,i.jsx)("input",{type:"checkbox",checked:m,onChange:()=>ev("All"),className:"rounded bg-zinc-700 border-zinc-600 text-orange-500 focus:ring-orange-500"}),(0,i.jsx)("span",{className:"text-sm text-white",children:"All"})]}),d.map(e=>(0,i.jsxs)("label",{className:"flex items-center space-x-2 cursor-pointer",children:[(0,i.jsx)("input",{type:"checkbox",checked:u.includes(e),onChange:()=>ev(e),className:"rounded bg-zinc-700 border-zinc-600 text-orange-500 focus:ring-orange-500"}),(0,i.jsx)("span",{className:"text-sm text-white",children:e})]},e))]})})]}),(0,i.jsxs)("button",{className:"flex items-center justify-center gap-1 sm:gap-2 px-3 sm:px-4 py-1.5 sm:py-2 bg-orange-500 rounded-full h-[40px] flex-shrink-0 whitespace-nowrap ml-auto md:ml-2",onClick:()=>A(!0),children:[(0,i.jsx)(q.Z,{className:"w-5 h-5 text-white"}),(0,i.jsx)("span",{className:"text-white font-medium text-sm",children:"Add event"})]})]})}),(0,i.jsx)("div",{className:"flex-1 overflow-y-auto pb-6 custom-scrollbar",children:(0,i.jsx)("div",{className:"w-full md:w-full lg:w-[397px] px-3 sm:px-4 md:px-0 md:ml-4",children:R?(0,i.jsxs)("div",{className:"bg-zinc-800 rounded-xl mb-4",children:[(0,i.jsxs)("div",{className:"flex justify-between items-center p-3 border-b border-zinc-700",children:[(0,i.jsx)("h3",{className:"text-lg font-semibold text-white",children:"Add New Event"}),(0,i.jsx)("button",{onClick:()=>A(!1),className:"text-zinc-400 hover:text-white transition-colors",children:(0,i.jsx)(P.Z,{className:"w-5 h-5"})})]}),(0,i.jsx)("form",{onSubmit:en(eh),className:"p-3 sm:p-4",children:(0,i.jsxs)("div",{className:"space-y-4",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"block text-sm font-medium text-zinc-400 mb-1",children:"Event Title"}),(0,i.jsx)("input",{...ea("title",{required:"Title is required",maxLength:{value:60,message:"Title must be less than 60 characters"}}),placeholder:"e.g., Math Study Group Session",className:"w-full bg-zinc-700 rounded-lg px-3 py-2 text-sm text-white focus:outline-none focus:ring-1 focus:ring-orange-500"}),er.title&&(0,i.jsx)("p",{className:"text-red-500 text-xs mt-1",children:er.title.message})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"block text-sm font-medium text-zinc-400 mb-1",children:"Description"}),(0,i.jsx)("textarea",{...ea("description",{required:"Description is required",maxLength:{value:250,message:"Description must be less than 250 characters"}}),placeholder:"Describe your event...",rows:3,className:"w-full bg-zinc-700 rounded-lg px-3 py-2 text-sm text-white focus:outline-none focus:ring-1 focus:ring-orange-500"}),er.description&&(0,i.jsx)("p",{className:"text-red-500 text-xs mt-1",children:er.description.message})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"block text-sm font-medium text-zinc-400 mb-1",children:"Email (.edu required)"}),(0,i.jsx)("input",{type:"email",...ea("email",{required:"Email is required",validate:e=>e.endsWith(".edu")||"Only .edu email addresses are allowed"}),placeholder:"your.email@university.edu",className:"w-full bg-zinc-700 rounded-lg px-3 py-2 text-sm text-white focus:outline-none focus:ring-1 focus:ring-orange-500"}),er.email&&(0,i.jsx)("p",{className:"text-red-500 text-xs mt-1",children:er.email.message})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"block text-sm font-medium text-zinc-400 mb-1",children:"Organizer Name"}),(0,i.jsx)("input",{...ea("organizerName",{required:"Organizer name is required"}),placeholder:"Your name",className:"w-full bg-zinc-700 rounded-lg px-3 py-2 text-sm text-white focus:outline-none focus:ring-1 focus:ring-orange-500"}),er.organizerName&&(0,i.jsx)("p",{className:"text-red-500 text-xs mt-1",children:er.organizerName.message})]}),(0,i.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-3",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"block text-sm font-medium text-zinc-400 mb-1",children:"Date"}),(0,i.jsx)("input",{type:"date",...ea("date",{required:"Date is required"}),className:"w-full bg-zinc-700 rounded-lg px-3 py-2 text-sm text-white focus:outline-none focus:ring-1 focus:ring-orange-500"}),er.date&&(0,i.jsx)("p",{className:"text-red-500 text-xs mt-1",children:er.date.message})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"block text-sm font-medium text-zinc-400 mb-1",children:"Start Time"}),(0,i.jsx)("input",{type:"time",...ea("startTime",{required:"Start time is required"}),className:"w-full bg-zinc-700 rounded-lg px-3 py-2 text-sm text-white focus:outline-none focus:ring-1 focus:ring-orange-500"}),er.startTime&&(0,i.jsx)("p",{className:"text-red-500 text-xs mt-1",children:er.startTime.message})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"block text-sm font-medium text-zinc-400 mb-1",children:"End Time"}),(0,i.jsx)("input",{type:"time",...ea("endTime",{required:"End time is required"}),className:"w-full bg-zinc-700 rounded-lg px-3 py-2 text-sm text-white focus:outline-none focus:ring-1 focus:ring-orange-500"}),er.endTime&&(0,i.jsx)("p",{className:"text-red-500 text-xs mt-1",children:er.endTime.message})]})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"block text-sm font-medium text-zinc-400 mb-1",children:"Location (Google Maps URL)"}),(0,i.jsx)("input",{...ea("location",{required:"Location is required"}),placeholder:"https://maps.google.com/...",className:"w-full bg-zinc-700 rounded-lg px-3 py-2 text-sm text-white focus:outline-none focus:ring-1 focus:ring-orange-500"}),er.location&&(0,i.jsx)("p",{className:"text-red-500 text-xs mt-1",children:er.location.message})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"block text-sm font-medium text-zinc-400 mb-1",children:"Event Type"}),(0,i.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-2",children:d.map(e=>(0,i.jsxs)("label",{className:"flex items-center space-x-2",children:[(0,i.jsx)("input",{type:"checkbox",value:e,...ea("event_type",{required:"Select at least one event type"}),className:"rounded bg-zinc-700 border-zinc-600 text-orange-500 focus:ring-orange-500"}),(0,i.jsx)("span",{className:"text-sm text-white",children:e})]},e))}),er.event_type&&(0,i.jsx)("p",{className:"text-red-500 text-xs mt-1",children:er.event_type.message})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"block text-sm font-medium text-zinc-400 mb-1",children:"Max Participants"}),(0,i.jsx)("input",{type:"number",...ea("max_participants",{required:"Max participants is required",min:{value:1,message:"Must be at least 1"}}),placeholder:"10",className:"w-full bg-zinc-700 rounded-lg px-3 py-2 text-sm text-white focus:outline-none focus:ring-1 focus:ring-orange-500"}),er.max_participants&&(0,i.jsx)("p",{className:"text-red-500 text-xs mt-1",children:er.max_participants.message})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"block text-sm font-medium text-zinc-400 mb-1",children:"RSVP Link (Optional)"}),(0,i.jsx)("input",{...ea("rsvp_link"),placeholder:"https://...",className:"w-full bg-zinc-700 rounded-lg px-3 py-2 text-sm text-white focus:outline-none focus:ring-1 focus:ring-orange-500"}),er.rsvp_link&&(0,i.jsx)("p",{className:"text-red-500 text-xs mt-1",children:er.rsvp_link.message})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"block text-sm font-medium text-zinc-400 mb-1",children:"Password (for editing event)"}),(0,i.jsx)("input",{type:"password",...ea("password",{required:"Password is required"}),className:"w-full bg-zinc-700 rounded-lg px-3 py-2 text-sm text-white focus:outline-none focus:ring-1 focus:ring-orange-500"}),er.password&&(0,i.jsx)("p",{className:"text-red-500 text-xs mt-1",children:er.password.message})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"block text-sm font-medium text-zinc-400 mb-1",children:"Event Image"}),(0,i.jsxs)("div",{className:"flex flex-wrap sm:flex-nowrap items-center gap-2 sm:space-x-4",children:[(0,i.jsx)("input",{type:"file",accept:"image/*",...ea("image"),className:"text-sm text-zinc-400 w-full sm:w-auto file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-orange-500 file:text-white hover:file:bg-orange-600"}),(Z||X)&&(0,i.jsx)("button",{type:"button",onClick:()=>{ed("image",void 0),V(null),Q(null),B(!1),$(null)},className:"text-zinc-400 hover:text-white",children:(0,i.jsx)(P.Z,{className:"w-5 h-5"})})]}),O&&Z&&(0,i.jsxs)("div",{className:"mt-4 border border-zinc-700 rounded-lg p-3 sm:p-4",children:[(0,i.jsx)("h4",{className:"text-white text-sm font-medium mb-2",children:"Crop Image (1:1.2 ratio)"}),(0,i.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,i.jsxs)("div",{className:"relative flex-1",children:[(0,i.jsx)(I.ZP,{crop:W,onChange:e=>H(e),onComplete:eu,aspect:1/1.2,className:"max-w-full",children:(0,i.jsx)("img",{ref:J,src:Z,alt:"Preview",className:"max-w-full"})}),(0,i.jsxs)("div",{className:"absolute inset-0 pointer-events-none grid grid-cols-3 grid-rows-3",children:[(0,i.jsx)("div",{className:"border-r border-b border-white/30"}),(0,i.jsx)("div",{className:"border-r border-b border-white/30"}),(0,i.jsx)("div",{className:"border-b border-white/30"}),(0,i.jsx)("div",{className:"border-r border-b border-white/30"}),(0,i.jsx)("div",{className:"border-r border-b border-white/30"}),(0,i.jsx)("div",{className:"border-b border-white/30"}),(0,i.jsx)("div",{className:"border-r border-white/30"}),(0,i.jsx)("div",{className:"border-r border-white/30"}),(0,i.jsx)("div",{})]})]}),(0,i.jsxs)("div",{className:"w-full",children:[(0,i.jsx)("h5",{className:"text-white text-sm font-medium mb-2",children:"Event Card Preview"}),(0,i.jsxs)("div",{className:"bg-zinc-800 rounded-xl overflow-hidden shadow-md max-w-md mx-auto",children:[G&&(0,i.jsx)("div",{className:"relative h-36 w-full bg-zinc-700",children:(0,i.jsx)("canvas",{ref:e=>{if(e&&J.current&&G){let i=e.getContext("2d");if(i){var t,s;let l=J.current,a=l.naturalWidth/l.width,n=l.naturalHeight/l.height;e.width=(null===(t=e.parentElement)||void 0===t?void 0:t.clientWidth)||G.width,e.height=(null===(s=e.parentElement)||void 0===s?void 0:s.clientHeight)||G.height,i.imageSmoothingEnabled=!0,i.imageSmoothingQuality="high",i.clearRect(0,0,e.width,e.height),i.drawImage(l,G.x*a,G.y*n,G.width*a,G.height*n,0,0,e.width,e.height)}}},className:"absolute inset-0 w-full h-full object-cover"})}),(0,i.jsxs)("div",{className:"p-3",children:[(0,i.jsx)("div",{className:"h-4 w-3/4 bg-zinc-700 rounded mb-2"}),(0,i.jsx)("div",{className:"h-3 w-1/2 bg-zinc-700 rounded mb-3"}),(0,i.jsxs)("div",{className:"flex justify-between",children:[(0,i.jsx)("div",{className:"h-6 w-16 bg-zinc-700 rounded"}),(0,i.jsx)("div",{className:"h-6 w-6 bg-zinc-700 rounded-full"})]})]})]}),(0,i.jsx)("p",{className:"text-xs text-zinc-400 mt-2",children:"This is how your image will appear in the event card."})]})]}),(0,i.jsx)("div",{className:"flex justify-end mt-4",children:(0,i.jsx)("button",{type:"button",onClick:ep,className:"px-3 py-1 bg-orange-500 text-white rounded-md text-sm",children:"Confirm Crop"})})]}),!O&&X&&(0,i.jsx)("div",{className:"mt-2",children:(0,i.jsx)("img",{src:X,alt:"Preview",className:"w-full max-w-xs h-auto object-cover rounded-lg"})})]}),(0,i.jsx)("div",{className:"flex justify-end pt-2",children:(0,i.jsx)("button",{type:"submit",disabled:F,className:"flex items-center justify-center px-4 py-2 bg-orange-500 hover:bg-orange-600 rounded-lg text-white font-medium transition-colors",children:F?"Creating...":"Create Event"})})]})})]}):(0,i.jsx)("div",{className:"space-y-4",children:ew.map(e=>(0,i.jsx)("div",{ref:e.id===s?f:null,className:"w-full",children:(0,i.jsx)(y,{event:e,isSelected:s===e.id,onClick:()=>n(e.id||""),onEdit:()=>{o&&o()}})},e.id))})})})]})]})}async function A(){return new Promise(e=>{if(!navigator.geolocation){console.error("Geolocation is not supported"),e(null);return}navigator.geolocation.getCurrentPosition(t=>{let{latitude:s,longitude:i}=t.coords;e([s,i])},t=>{console.error("Error getting location:",t),e(null)})})}function F(){let[e,t]=(0,l.useState)(null),[s,n]=(0,l.useState)([]),[r,o]=(0,l.useState)(!0),[c,d]=(0,l.useState)(null),[m,p]=(0,l.useState)(null),h=e=>{m===e?p(null):p(e)};return((0,l.useEffect)(()=>{(async function(){try{let e=await A();e&&t(e);let{data:s,error:i}=await a.from("events").select("*").order("startTime",{ascending:!0});if(i)throw i;s&&n(s)}catch(e){console.error("Error initializing:",e)}finally{o(!1)}})()},[]),(0,l.useEffect)(()=>{(async function(){try{if(c){let e=c.getFullYear(),t=String(c.getMonth()+1).padStart(2,"0"),s=String(c.getDate()).padStart(2,"0"),i="".concat(e,"-").concat(t,"-").concat(s);console.log("Filtering events for date:",i);let{data:l,error:r}=await a.from("events").select("*").eq("date",i).order("startTime",{ascending:!0});if(r)throw r;l&&(console.log("Found events:",l.length),n(l))}else{let{data:e,error:t}=await a.from("events").select("*").order("date",{ascending:!0});if(t)throw t;e&&n(e)}}catch(e){console.error("Error fetching events by date:",e)}})()},[c]),r)?(0,i.jsx)(u,{}):(0,i.jsx)("div",{className:"flex flex-col min-h-screen bg-black overflow-hidden",children:(0,i.jsx)("div",{className:"p-2 sm:p-3 md:p-5 h-screen overflow-hidden",children:(0,i.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-1 lg:grid-cols-[35%_65%] xl:grid-cols-[30%_70%] gap-0 h-[calc(100vh-16px)] sm:h-[calc(100vh-24px)] md:h-[calc(100vh-40px)] overflow-hidden",children:[(0,i.jsx)("div",{className:"h-[60vh] sm:h-[55vh] md:h-[50vh] lg:h-full overflow-hidden order-1",children:(0,i.jsx)(R,{events:s,selectedEvent:m,onEventSelect:h,onDateSelect:e=>d(e),onEventAdded:()=>{a.from("events").select("*").order("startTime",{ascending:!0}).then(e=>{let{data:t,error:s}=e;if(s){console.error("Error refreshing events:",s);return}t&&n(t)})},onEventUpdated:()=>{a.from("events").select("*").order("startTime",{ascending:!0}).then(e=>{let{data:t,error:s}=e;if(s){console.error("Error refreshing events:",s);return}t&&n(t)})}})}),(0,i.jsx)("div",{className:"h-[calc(40vh-16px)] sm:h-[calc(45vh-24px)] md:h-[calc(50vh-20px)] lg:h-full overflow-hidden rounded-3xl lg:-ml-8 order-2",children:(0,i.jsx)(x,{events:s,selectedEvent:m,userPos:e,onEventSelect:h})})]})})})}}},function(e){e.O(0,[528,415,996,971,23,744],function(){return e(e.s=2110)}),_N_E=e.O()}]);